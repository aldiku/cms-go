{{ define "content" }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.3/ace.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<div class="w-full mx-auto py-8">
  <h1 class="text-2xl font-bold mb-6">Edit Layout: {{.Layout.Name}}</h1>

  <form method="POST" action="/admin/layouts/{{.Layout.ID}}/edit" class="space-y-6">

    <!-- Name Input -->
    <div>
      <label for="name" class="block text-gray-700 font-medium mb-2">Name:</label>
      <input
        type="text"
        id="name"
        name="name"
        value="{{.Layout.Name}}"
        required
        class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <!-- Structure Editor -->
    <div>
      <label for="structure" class="block text-gray-700 font-medium mb-2">Structure (JSON):</label>
      <textarea id="structure" name="structure" style="display:none;">{{.Layout.Structure}}</textarea>
      <div id="editor-structure" class="h-64 border border-gray-300 rounded shadow-sm">{{.Layout.Structure}}</div>
    </div>

    <!-- Template Editor -->
    <div>
      <label for="template" class="block text-gray-700 font-medium mb-2">Template (HTML with Go syntax):</label>
      <textarea id="template" name="template" style="display:none;">{{.Layout.Template}}</textarea>
      <div id="editor-template" class="h-64 border border-gray-300 rounded shadow-sm">{{.Layout.Template}}</div>
    </div>

    <!-- Submit Button -->
    <div>
      <button
        type="submit"
        class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-colors"
      >
        Save Changes
      </button>
    </div>

  </form>

  <p class="mt-4 text-gray-600">
    <a href="/admin/layouts" class="text-blue-500 hover:underline">‚Üê Back to Layouts</a>
  </p>
</div>

<script>
  // Initialize Structure editor
  var editorStructure = ace.edit("editor-structure");
  editorStructure.setTheme("ace/theme/monokai");
  editorStructure.session.setMode("ace/mode/json");
  editorStructure.setOption("wrap", true);

  // Initialize Template editor
  var editorTemplate = ace.edit("editor-template");
  editorTemplate.setTheme("ace/theme/monokai");
  editorTemplate.session.setMode("ace/mode/html");
  editorTemplate.setOption("wrap", true);

  // Sync editors with hidden textareas before submit
  var form = document.querySelector("form");
  form.addEventListener("submit", function() {
    document.getElementById("structure").value = editorStructure.getValue();
    document.getElementById("template").value = editorTemplate.getValue();
  });
</script>
{{ end }}
